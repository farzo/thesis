\chapter{Conclusion and Future Work}
\label{conclusion-and-future-work}
\thispagestyle{empty}
\paragraph{}
This project introduced two new tools for detection of vulnerable web applications. The approaches used in these tools are different from common web scanners, such as skipfish. In this project we focused more on detecting vulnerable applications as soon as possible by monitoring publicly available vulnerability information. Once we are aware of the vulnerability, we can take two approaches to detect vulnerable resources. If the vulnerability is specific to a software or product, VNT described in Chapter \ref{vulnerability-notification-tool} will report resources that use those products. In other cases when the vulnerability is not specific to one product, e.g. an expired certificate, or detecting the technology on resources is not possible or efficient, e.g detecting technologies not supported by WAD, the Scanner as described in Chapter \ref{scanner} can be used to run other detection scripts. In addition, the Scanner can be used to run automated regular scans of the whole web infrastructure at CERN and analyze the scan results automatically. Both these tools are currently being used at CERN to enhance the vulnerability management process of web applications, but there is a potential for improvements in both of them. 
 
\subsection{Vulnerability Notification Tool}
VNT can be used to get informed about all vulnerabilities, regardless of the product they affect or whether they are web-related. At the moment, it stores all these findings in parsable files. Therefore, it can become a part of the vulnerability management mechanism to help keeping track of vulnerabilities. It is possible to extend VNT and evolve it into a vulnerability management framework, where users can decide to ignore some vulnerabilities or get different notifications based on the type of changes that happen in a vulnerability data.
\paragraph{}
The performance of VNT is highly dependent on the vulnerability source it is using. At the time of doing this project, we decided on using NVD,  but it is important to keep an eye on the market and use other sources instead of -or along with- NVD, if they fit our needs as described in Section \ref{vuln_sources}. 

\paragraph{}
One of the main challenges while using NVD as the vulnerability source, was the randomness of CPE names. Although CPE is introduced as a standard way of enumerating platforms, there are still many problems with it. Its dictionary is incomplete and contains redundant entries, such as multiple CPE names for the same product. On the other hand, it seems that the available vulnerability sources have not agreed on a standard way of listing vulnerable software and each has come up with its own format. The mapping algorithm as described in Section \ref{name_matching} has been tested on NVD CPE data, but would probably be rather efficient on other naming formats with some minor changes, however, there seems to be a need for a standard format that is complete and robust enough, so that the community can agree on it.

\paragraph{}
The product name matching algorithm that we are currently using to find vulnerable products can also be improved. The current algorithm as described in Section \ref{name_matching} ignores the category of WAD names. A possible improvement to the algorithm would be to report matches only if the CPE type (first field of the CPE name) and WAD category match (e.g. both are operating systems). Another improvement is to use available algorithms for computing the string distance between CPE and WAD names, reporting only the pairs that have a similarity level higher than a decided threshold.  
\paragraph{}
NVD reports a list of affected product versions, but this data changes very often. we noticed that previously announced vulnerable versions sometimes get removed from NVD updates or versions that were not reported as vulnerable, enter the list. There are many cases that a vulnerability information gets updated on NVD with a small change in the sub-sub-version of an affected product. If VNT were sending update notifications for every change in affected product versions, it would flood the user mailbox with update emails, encouraging the users to ignore its emails completely. Therefore, in the current tool, we decided to ignore the changes in product versions. Apparently, knowing about these changes can be useful in some cases. Imagine that there is a vulnerability that is affecting Drupal version 6. We might decide to ignore this vulnerability at CERN, because all Drupal instances are using version 7 or higher. If in a couple of days, NVD updates the same vulnerability and lists Drupal 7 as a vulnerable product, we would definitely like to receive an update notification. As you can see, there is a trade-off here and it can be an open question to the CERN Computer Security Team to decide if they would rather receive more email notifications (among which many are useless), but not miss important product version changes in vulnerability information or at least create a list of products that we would like to monitor their version changes in NVD feeds (This list can contain products, such as Drupal, Wordpress, etc.).
\paragraph{}
For the time being, VNT is sending email notifications to the CERN Computer Security Team members rather than resource owners. The reason is that, in most cases further investigation of a vulnerability is needed to make sure that the reported resources are indeed affected. One step towards fully automating the tool is to consider product versions when reporting the resources.
\\
The product version reported by WAD is not always reliable, e.g. Apache servers might be reported to have obsolete versions while the new updates have been backported to them. In addition, WAD is unable to detect the version of many products, e.g. CakePHP framework. Due to these limitations, we decided to ignore product versions when reporting vulnerable resources and leave it to the investigator of the vulnerability to decide if a certain resource is indeed affected. Once we have more reliable version detection on WAD, the tool can be slightly changed to only report resources that use a certain version of a product.
\paragraph{}
Used in a slightly different way, VNT can be used to make sure that new resources at CERN are not vulnerable. Whenever there is a new resource detected by WAD, we can use VNT data to ensure that this new resource is not vulnerable to recently found vulnerabilities.
\subsection{Scanner}
\paragraph{}
The Scanner facilitates running individual detection scripts on CERN resources. Currently, it supports detection scripts that run on websites and web servers (devices). It can be easily extended to support other types of resources at CERN. For example CERN is managing user accounts and each of these accounts can be considered as a resource. One can think of scanning all accounts at CERN to find out if the password has been exposed ( for example when a list of exposed email addresses and passwords is published publicly) and write a detection script for this purpose. The scanner can be used to run this script on all accounts at CERN. The Scanner just needs to be extended to receive relevant inputs regarding the type of the resource and call the detection script with these inputs.
\\