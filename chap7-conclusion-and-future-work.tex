\chapter{Conclusion and Future Work}
\label{conclusion-and-future-work}
\thispagestyle{empty}
This project introduced two new tools for detection of vulnerable web applications deployed in a large IT installation. The approaches used in these tools are different from common web scanners, such as Skipfish. In this project we focused more on detecting vulnerable applications as soon as possible by monitoring publicly available vulnerability information. Once we are aware of a vulnerability, we can take two approaches to detect applications that may be a subject to it. If the vulnerability is specific to a software or product, VNT described in Chapter \ref{vulnerability-notification-tool} will report the resources (applications) that use those products. In other cases when the vulnerability is not specific to one product but to its configurations, e.g. an expired certificate, or when detecting the vulnerable technology on resources or applications is not possible or efficient, e.g detecting technologies not supported by WAD, the Scanner (Chapter \ref{scanner}) can be used to run other detection scripts. In addition, the Scanner can be used to run automated regular scans of the whole web infrastructure at CERN and analyze the scan results automatically. Both these tools are currently being used at CERN to enhance the vulnerability management process of web applications, but there is a potential for improvements in both of them. 
 
\subsection{Vulnerability Notification Tool}
VNT can be used to get informed about all vulnerabilities, regardless of the product they affect or whether they are web-related. At the moment, it stores all these findings in parsable files. Therefore, it can become a part of the vulnerability management mechanism to help keep track of vulnerabilities. It is possible to extend VNT and evolve it into a vulnerability management framework, where users can decide to ignore some vulnerabilities or get different notifications based on the type of the changes that happen in a vulnerability data.
\paragraph{}
The performance of VNT is highly dependent on the vulnerability source it is using. At the time of this project, it was decided to use NVD,  but it is important to keep an eye on the market and use other sources instead of --or along with-- NVD, if they fit the needs described in Section \ref{source_evaluation}. 

\paragraph{}
One of the main challenges while using NVD as the vulnerability source, was the randomness of CPE names. Although CPE is introduced as a standard way of enumerating platforms, there are still many problems with it: Its dictionary is incomplete and contains redundant entries, such as multiple CPE names for the same product. On the other hand, it seems that the available vulnerability sources have not agreed on a standard way of listing vulnerable softwares and each has come up with its own format. The CPE name mapping algorithm described in Section \ref{name_matching} has been tested on NVD CPE data, but would probably be efficient enough on other naming formats with some minor changes. In any case, there seems to be a need for a standard product naming format that is complete and robust enough to meet the requirements of all interested parties. 

\paragraph{}
The product name matching algorithm that is currently being using to find vulnerable products can also be improved. In addition to application names, WAD provides the category (type) of each application. The current algorithm described in Section \ref{name_matching} ignores the category of WAD names. A possible improvement to the algorithm would be to report matches only if the CPE type (first field of the CPE name) and WAD category match (e.g. both are operating systems). Another potential improvement is to use available algorithms for computing the string distance between CPE and WAD names, reporting only the pairs that have a similarity higher than a decided threshold.  
\paragraph{}
NVD reports a list of affected product versions, but this data changes very often. One can notice that previously announced vulnerable versions sometimes get removed from NVD updates or versions that were not reported as vulnerable, enter the list. There are many cases where vulnerability information gets updated on NVD with a small change in the sub-sub-version of an affected product. If VNT was sending update notifications for every change in affected product versions, it would flood its users with updates, encouraging them to ignore such notifications completely. Therefore, in the current tool, we decided to ignore any changes in product versions. Apparently, knowing about these changes can be useful in some cases. Imagine that there is a vulnerability that is affecting Drupal version 6. We might decide to ignore this vulnerability at CERN, because all Drupal instances are using version 7 or higher. If a couple of days later, NVD updates the same vulnerability and lists Drupal 7 as a vulnerable product, we would definitely like to receive an update notification. As one can see, there is a trade-off here and it can be an open question to the CERN Computer Security Team to decide if they would rather receive more notifications (among which many are useless), for the sake of not missing important product version changes in vulnerability information.
\paragraph{}
For the time being, VNT is sending email notifications to the CERN Computer Security Team members rather than the resource owners. The reason is that, in most cases, further investigation of a vulnerability is needed to make sure that the reported resources are indeed affected. One step towards fully automating the tool is to consider product versions when reporting the resources.
\paragraph{}
The product version reported by WAD, however, is not always reliable. For instance, Apache servers might be reported to have obsolete versions while the new updates have been back-ported\footnote{Parts of a newer version of a software have been added to an older version of the same software, without upgrading} to them. In addition, WAD is unable to detect the version of many products, e.g. CakePHP framework. Due to these limitations, it was decided to ignore product versions when reporting vulnerable resources and leave it to the investigator of the vulnerability to decide if a certain resource is indeed affected. Once WAD supports more reliable version detection, VNT can be slightly changed to only report resources that use a certain version of a product.
\paragraph{}
Used in a slightly different way, VNT can be used to make sure that new resources at CERN are not vulnerable. Whenever there is a new resource detected by WAD, we can use VNT data to ensure that this new resource is not vulnerable to recently found vulnerabilities.
\subsection{Scanner}
The Scanner facilitates running individual detection scripts on CERN resources. Currently, it supports detection scripts that run on websites and web servers (devices). It can be easily extended to support other types of resources at CERN. For example, CERN is managing user accounts and each of these accounts can be considered as a resource. Each account is associated with an AFS space and one can think of scanning all accounts at CERN to find out if a user is storing his private keys in an AFS public folder. This is a security risk for the user, because everyone in the organization will have access to his private key. The Scanner can be used to run this script on all accounts at CERN if provided with relevant inputs to pass into the detection script.
%% change the example: for example talk about checking public / private key available on AFS
%a password has been exposed (when a list of exposed email addresses and passwords is advertised publicly) and write a detection script for this purpose. 
\\