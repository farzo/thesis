\chapter{Introduction}
\label{introduction}
\thispagestyle{empty}
\paragraph{}
Web applications are getting more and more popular every day. One can think of different reasons for this increase in popularity: ubiquity of web browsers makes it convenient to use them as a client; web applications can be updated and maintained locally with no need to distribute or install software on client side and web applications are cross-platform compatible.
Another reason for the increasing popularity of web applications is the simplicity of developing them. Nowadays there are many web application frameworks and content management systems that facilitate rapid application development. This simplicity comes with a cost: securing a web application is difficult. Web applications include code that resides on the web servers, application servers, databases, and back-end systems of an organization. The potential for a security breech exists in each of these layers. This opens the door to attackers trying to manipulate the application logic to achieve their needs\cite{secure_web}.
\paragraph{}
Even if a web application is developed as secure as possible, it is important to keep it secure by constantly checking for newly discovered vulnerabilities and making sure that the application is not affected. This task is easier if we manage the web application in each layer ourselves and we are aware of all the technologies that are used in an application; however, in many organizations like CERN, any employee can set up a web server or launch a website. It is the job of the Computer Security team to scan these various web servers and websites and detect all vulnerabilities remotely.
\paragraph{}
There are two main approaches for ensuring the security of web applications. The first approach is to use the available automatic scanning tools, such as skipfish, to detect vulnerabilities. This method helps to find the common vulnerabilities, but when a new vulnerability emerges we have to wait for the new version of the scanning tool to be released and contain tests for the new vulnerability. Also, due to the complexity of these tools, it is a time consuming task to configure them for a specific scanning purpose. 
The second approach is to keep an eye on vulnerability sources, databases, security mailing lists, etc. to get informed about new vulnerabilities as soon as possible. This way we won't miss any critical vulnerabilities. The next step is to use the vulnerability information and detect the vulnerable resources in the organization. This project describes two different methods for this purpose. Chapter \ref{vulnerability-notification-tool} takes advantage of publicly available vulnerability sources and describes a tool -Vunlerability Notification System- that matches  vulnerable products (as announced in vulnerability information) to the products used at CERN and reports potential vulnerable resources. Chapter \ref{scanner} introduces a new tool -Scanner- to facilitate scanning the resources with simple (home-grown) security tests (short scripts) that detect a single vulnerability on resources. Heartbleed\footnote{Critical OpenSSL vulnerability, discovered in April 2014} is a good example of a case when it was critical to detect vulnerable resources as soon as possible. The vulnerability was not specific to a single product and most organizations had to use their own (or publicly available) scripts to detect the vulnerability and patch the resources.

\section{Definitions}

\textbf{Vulnerability}: According to CVE MITRE, a vulnerability is a mistake in software that can be directly used by a hacker to gain access to a system or network. A vulnerability would allow an attacker to:
\begin{itemize}
\item execute commands as another user
\item access data that is contrary to the specified access restrictions for that data
\item pose as another entity
\item conduct a denial of service
\end{itemize}

Mis configuration

Web application
vulnerability source

if there are some literature to explain. what is a vulnerability for example?

What is a vulnerability? Terminology? (useful for the thesis) 
\url{http://cve.mitre.org/about/terminology.html#Dist}\url{http://www.osvdb.org/vuln_standards}

\section{CERN Web Landscape}
Web applications are getting much more popular . they are easy to develop but not so easy to to develop securely
vulnerable web app can make the server, database, internal network, data etc. insecure
they are publicly available
easy target for attackers

\subsection{Web Application Stack}
vulnerability can occur in each of the layers
\begin{itemize}
\item web server misconfigurations and vulnerabilities (like certificate related, weak ciphers, heartbleed) 
\item web application vulnerabilities
\item unpatched or outdated web applications
\end{itemize}


software that is used in each layer
\begin{itemize}
\item developed internally
\item used out of the box
\end{itemize}
examples of each
if out of the box the vulnerabilities are usually discovered and reported in the public.
internally developed ones need to be checked before open to outside

\subsection{CERN Websites}
There are two types of websites and web servers used at CERN.
\subsubsection{centrally hosted websites}
These websites are hosted centrally by the IT department. Currently there are about 13k instances of these websites. Each of them has a URL in the format of \texttt{\url{http://cern.ch/X}} or \texttt{\url{http://X.web.cern.ch}}, where X is the name of the website. Examples like \url{http://home.web.cern.ch/}. Managed by WebServices \url{http://cern.ch/web} and could have various types 
(file/application hosting:)

IIS (Windows), files on DFS ( PHP, ASP)

Apache (Linux), files on AFS(PHP, CGI)

J2EE(Java) 
CMS (Content Management Systems) (Drupal) PHP
SharePoint
Social community











different types ... explain!
\subsubsection{Non Centrally Hosted}

On the other hand, one can find between 10k to 20k instances of dedicated web servers at CERN (?) in the format of \url{http://X.cern.ch} and examples like \url{http://indico.cern.ch/}

Any technology stack (OS, web server, application platform
and frameworks etc. etc.)
Many visible only inside CERN

Others have firewall openings

visible from outside

[[Some numbers and figures about each category]]


\section{CERN Web Security}
current approach to ensure the security of the web applications
\subsection{Prevention}
people are encouraged to use the central services. explain why?
firewall opening procedure

\subsection{Detection}
two main areas where the vulnerabilities emerge
\subsubsection{Detection Scripts}
small scripts that are developed inside to detect vulnerable sources, most of the time when a new vuln is announced( heart bleed, shell shock, ssl3) and there is no patch yet, but some times also for mis-configuration detection (empty landing page, http authentication)
\subsubsection{Published Vulnerabilities}
vulnerabilities affecting a third part software and published in mailing lists, other sources, etc. example wordpress
usually the vulnerabilities that are from well known software, human decision if we are going to care about the vulnerability and checking if the affected software is used at CERN.

\subsection{Relevant Tools}
\label{sec:tools}
\subsubsection{WAS}
\subsubsection{WASDOM}
\subsubsection{List of websites and webservers}
\subsubsection{WAD and Wappalyzer}
\label{wad_section}
wana talk abut pushing upstream?
\subsubsection{SSDB?}
\subsubsection{Auto-notify?}

***an image of the architecture: ssdb, autonotify, skipfish, nmap, etc.


\section{Objectives}
improving the current approaches
\begin{itemize}
\item each script its own format. there is a need for a wrapper that has a unique format, scripts can deal with only one resource and ... [scanner-> chapter]
\item missing vulnerabilties that do not create big noises in the public, manual check for wad outputs that match. Automate the monitoring of vulnerabilities to improve speed and accuracy of responding to vulnerabilities and automate the affected resource detection. [vunerability nitification tool -> chapter]

\item approaches for security, automated tools fo not discover everything
\end{itemize}

























